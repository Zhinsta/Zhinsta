{% extends "base.html" %}
{% set body_class="page-media" %}
{% block style %}
<link rel="stylesheet" href="/static/css/font-awesome/css/font-awesome.min.css" />
<link rel="stylesheet" href="/static/css/media.css"/>
{% endblock %}
{% block main %}
<div class="main">
    <div class="info">
        <div class="info-l">
            <a href="{{ url_for('view.profile', ukey=media.user.id) }}">
            <img width="50" height="50" src="{{ media.user.profile_picture }}" alt="{{ media.user.full_name }}" />
            </a>
            <div class="info-l-txt">
                <h1>{{ media.user.username }}
                    {% if not isme %}
                    {% if isfollow %}
                    <a href="#" class="jsFollow" data-ukey="{{ user.id }}" data-action="unfollow" title="取消关注">正在关注</a>
                    {% else %}
                    <span></span>
                    <a href="#" class="jsFollow" data-ukey="{{ user.id }}" data-action="follow" title="关注TA">未关注</a>
                    {% endif %}
                    {% endif %}
                </h1>
                <!--
                <p><i class="icon-plus"></i><a href="#" class="js-collect">收录到中文圈</a></p>
                <p><i class="icon-bookmark"></i>已收录到中文圈</p>
                -->
            </div>
        </div>
    </div>

    <div class="media">
        <div class="media-l">
            <img src="{{ media.get_standard_resolution_url() }}" alt="" />
        </div>
        <div class="media-r">
            <div class="media-info">
                <p>
                    <span class="media-time">{{ media.created_time|time_since }}</span>
                    <span class="media-place"></span>
                </p>
                <p class="media-desc">
                    {{ media.caption.text }}
                </p>
                <p>
                    {% for tag in (media.tags or []) %}
                    <a href="{{ url_for('view.tag', name=tag.name) }}" class="tag">#{{ tag.name }}</a>&nbsp;
                    {% endfor %}
                </p>
            </div>

            <div class="media-love">
                <a href="#" class="jsLove" data-action="like" data-num="{{ media.like_count }}" data-mid="{{ media.id}}">
                        <i class="icon-heart"></i><span>{{ media.like_count }}</span>
                </a>
                <!--
                <a href="#" class="jsLove" data-action="unlike" data-num="{{ media.like_count }}" data-mid="{{ media.id}}">
                        <i class="icon-heart loved"></i><span class="loved">{{ media.like_count }}</span>
                </a>
                -->
                <p class="media-lovers">
                    {% for like in likes %}
                    <a href="{{ url_for('view.profile', ukey=like.id) }}">{{ like.username }}</a>
                    {% endfor %}
                    等人赞过
                </p>
            </div>
        </div>
    </div>

    {% if media.comments %}
    <div class="comments">
        <h2>大家在说</h2>
        <ul>
            {% for comment in media.comments %}
            <li>
            <a href="{{ url_for('view.profile', ukey=comment.user.id) }}">
                    <img src="{{ comment.user.profile_picture }}" alt="{{ comment.user.full_name }}" />
                </a>
                <div class="comments">
                    <a href="{{ url_for('view.profile', ukey=comment.user.id) }}">{{ comment.user.username }}</a>
                    <p>{{ comment.text }}</p>
                </div>
            </li>
            {% endfor %}
        </ul>
    </div>
    {% endif %}
</div>

<script src="/static/js/jquery.min.js"></script>
<script src="/static/js/g.min.js"></script>
{% endblock %}
